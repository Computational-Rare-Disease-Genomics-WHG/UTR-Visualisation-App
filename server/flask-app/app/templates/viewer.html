<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>UTR Visualisation App</title>
      <!-- Google Font: Source Sans Pro -->
      <link rel="preconnect" href="https://fonts.gstatic.com">
      <!--Favicon--> 
      <!--link rel="shortcut icon" href="{{url_for('static', filename = 'assets/favicon.png')}}"/>-->
      <link href="https://fonts.googleapis.com/css2?family=Alegreya+Sans:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap" rel="stylesheet">
      <!-- Font Awesome -->
      <link rel="stylesheet" href="{{url_for('static', filename = 'plugins/fontawesome-free/css/all.min.css')}}">
      <link rel="stylesheet" href="{{url_for('static', filename = 'plugins/fontawesome-free/css/brands.css')}}">
      <!-- Ionicons -->
      <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
      <!-- Tempusdominus Bootstrap 4 -->
      <link rel="stylesheet" href="{{url_for('static', filename = 'plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css')}}">
      <!-- iCheck -->
      <link rel="stylesheet" href="{{url_for('static', filename = 'plugins/icheck-bootstrap/icheck-bootstrap.min.css')}}">
      <!-- JQVMap -->
      <link rel="stylesheet" href="{{url_for('static', filename = 'plugins/jqvmap/jqvmap.min.css')}}">
      <!-- Theme style -->
      <link rel="stylesheet" href="{{url_for('static', filename = 'dist/css/adminlte.min.css')}}">
      <!-- overlayScrollbars -->
      <link rel="stylesheet" href="{{url_for('static', filename = 'plugins/overlayScrollbars/css/OverlayScrollbars.min.css')}}">
      <!-- Daterange picker -->
      <link rel="stylesheet" href="{{url_for('static', filename = 'plugins/daterangepicker/daterangepicker.css')}}">
      <!-- summernote -->
      <link rel="stylesheet" href="{{url_for('static', filename = 'plugins/summernote/summernote-bs4.min.css')}}">
      <script src="https://cdn.jsdelivr.net/gh/calipho-sib/feature-viewer@v1.1.0/dist/feature-viewer.bundle.js"></script>

      <link rel="stylesheet" href="{{url_for('static', filename = 'plugins/jsgrid/jsgrid.min.css')}}">
      <link rel="stylesheet" href="{{url_for('static', filename = 'plugins/jsgrid/jsgrid-theme.min.css')}}">
    


      <style type="text/css">
         .select2-container--default .select2-selection--multiple .select2-selection__choice {
            background-color: #007bff; 
            border-color: #006fe6;
         }
         p, h1, h2, h3, h4,h5, h6, a{
            font-family:'Lato';
         }
      </style>
   </head>
   <body class="hold-transition layout-fixed" id="main-content" >
      <div class="wrapper">
         <!-- Navbar -->
         <nav class="main-header navbar navbar-expand navbar-light" >
            <!-- Left navbar links -->
            <ul class="navbar-nav">
               <li class="nav-item d-none d-sm-inline-block">
                  <a href="#" class="nav-link">Home</a>
               </li>
               <li class="nav-item d-none d-sm-inline-block">
                  <a href="#" class="nav-link">About</a>
               </li>
               <li class="nav-item d-none d-sm-inline-block">
                  <a href="#" class="nav-link">Help</a>
               </li>
               <li class="nav-item d-none d-sm-inline-block">
                  <a href="#" class="nav-link">Contact</a>
               </li>
               <li class="nav-item d-none d-sm-inline-block">
                  <a href="#" class="nav-link">Changelog</a>
               </li>
               <li class="nav-item d-none d-sm-inline-block">
                  <a href="#" class="nav-link">Terms</a>
               </li>
               
               
            </ul>
            <!-- Right navbar links -->
            <ul class="navbar-nav ml-auto">
               <!-- Navbar Search -->
               <li class="nav-item">
                  <a class="nav-link" data-widget="fullscreen" href="#" role="button">
                  <i class="fas fa-expand-arrows-alt"></i>
                  </a>
               </li>
  
                
            </ul>
            
         </nav>
         <!-- /.navbar -->
            <!-- Main Sidebar Container -->
            <aside class="main-sidebar sidebar-dark-primary elevation-4"  >
               <!-- Brand Logo -->
               <div class="ml-3">
               </div>
               <!-- Sidebar -->
               <div class="sidebar">
                  <!-- Sidebar user panel (optional) -->
                  <div class="user-panel mt-3 pb-3 mb-3 mx-auto d-flex">
                     <div class="image">
                     </div>
                     <div class="info">
                       <h2 class="brand-text font-weight-light" style="color:white;">UTR Viz App</h2>

                     </div>
                  </div>
                       <!-- Sidebar user panel (optional) -->
 
 
       <!-- SidebarSearch Form -->
       <div class="form-inline">
         <div class="input-group" data-widget="sidebar-search">
           <input class="form-control form-control-sidebar" id="search-input" type="search" placeholder="Search" >
           <div class="input-group-append">
             <button class="btn btn-sidebar" onclick="window.location.href = '/viewer/'+ $('#search-input').val() ">
               <i class="fas fa-search fa-fw"></i>
             </button>
           </div>
         </div>
         <div>



         </div>
       </div>
                  <!-- SidebarSearch Form -->
                  <!-- Sidebar Menu -->
                        <!-- Sidebar Menu -->
      <nav class="mt-2">
         <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
           <!-- Add icons to the links using the .nav-icon class
                with font-awesome or any other icon font library -->
            {% for mesg in get_flashed_messages() %}
            <p class="login-box-msg nav-item" style="color:white;">{{ mesg }}</p>
            {% endfor %}

           <li class="nav-item">
            <a href="pages/widgets.html" class="nav-link">
              <i class="nav-icon fas fa-th"></i>
              <p>
                Search
              </p>
            </a>
          </li>

         </ul>
       </nav>
                  <!-- /.sidebar-menu -->
               </div>
               <!-- /.sidebar -->
            </aside>
         <!-- Content Wrapper. Contains page content -->
         <div class="content-wrapper" >
            <!-- Content Header (Page header) -->
            <div class="content-header">
               <div class="container-fluid">
                  <div class="row mb-2">
                     <div class="col-sm-6">
                        <h1 class="m-0"></h1>
                     </div>
                     <!-- /.col -->
                     <div class="col-sm-6">
                        <ol class="breadcrumb float-sm-right">
                           <li class="breadcrumb-item"><a href="#">Home</a></li>
                           <li class="breadcrumb-item active">{{ensembl_transcript_id}}({{gnomad_data["transcript"]["gene"]["symbol"]|safe}})</li>
                        </ol>
                     </div>
                     <!-- /.col -->
                  </div>
                  <!-- /.row -->
               </div>
               <!-- /.container-fluid -->
            </div>
            <!-- /.content-header -->
            <!-- Main content -->
            <section class="content" >
               <div class="container-fluid" >
                  <!-- Small boxes (Stat box) -->
                  <!-- /.row -->
                  <!-- Main row -->
                  <div class="row">
                     <!-- Left col -->
                     <section class="col-lg-12 ">
                        <!-- Custom tabs (Charts with tabs)-->
                        <div class="card ">
                           <div class="card-header bg-light">
                              <h3 class="card-title">
                                 <b>
                                    <i class="fas fa-dna"></i>

                                 Gene Details
                              </b>
                              </h3>
                              <div class="card-tools">
                                 <button type="button" id="dtype-creator-btn" class="btn btn-block btn-dark">
                                    <i class="fas fa-question-circle"></i>                                    
                                    
                                 </button>
                              </div>
                           </div>
                           <!-- /.card-header -->
                           <div class="card-body">
                              <div>
                                <h6><b>HGNC Symbol</b>: {{gnomad_data["transcript"]["gene"]["hgnc_id"]|safe}}</h6>
                                <h6><b>Gene Name</b>: {{gnomad_data["transcript"]["gene"]["name"]|safe}}</h6>
                                <h6><b>Ensembl Gene ID</b>: {{gnomad_data["transcript"]["gene"]["gene_id"]|safe}}</h6>
                                <h6><b>Ensembl Transcript ID</b>: {{ensembl_transcript_id}}</h6>
                                <h6><b>OMIM ID</b>:  {{gnomad_data["transcript"]["gene"]["omim_id"]|safe}}</h6>
                                 <h6><b>RefSeq Match</b>: {{gnomad_data["transcript"]["gene"]["mane_select_transcript"]["refseq_id"]|safe}}</h6>
                                 <h6><b>LOEUF <i class="fas fa-exclamation-circle"></i></b>: <span class="badge bg-warning"> (TODO) 0.61</span></h6>
                                 <h6><b>5' UTR exon count</b>:(TODO) 2</h6>
                                 <h6><b>5' UTR length</b>: (TODO) 400</h6>
                                 <h6><b>ClinGen Haploinsufficiency Score</b>: (TODO) 3</h6>
                                 <h6><b>External Resources</b>: View gene in 
                                    <a href="#">Ensembl</a>, 
                                    <a href="#">OMIM</a>,
                                    <a href="#">gnomAD</a>,
                                    <a href="#">sORFs.org</a>,
                                    <a href="#">ClinGen</a>,
                                    <a href="#">ClinVar</a>
                                 </h6>
                              </div>
                           </div>
                          
                        </div>
                        <!-- /.card -->
                        <!--/.direct-chat -->
                        <!-- /.card -->
                     </section>
                     <!-- right col -->
                  </div>
                  <!-- /.row (main row) -->
                  <!-- Main row -->

                
               </div>
               <!-- /.container-fluid -->
            </section>
            <section class="content">
               <div class="container-fluid">
                  <div class="row">
                  <section class="col-lg-12">
                     <div class="card">
                        <div class="card-header bg-light">
                           <h3 class="card-title">
                              <b>
                                 <i class="fas fa-info-circle"></i>
                              5' UTR Architechure (T0DO)
                           </b>
                           
                           </h3>
                           <div class="card-tools">
                              <button type="button" id="dtype-creator-btn" class="btn btn-block btn-dark">
                                 <i class="fas fa-question-circle"></i>                                    
                              </button>
                           </div>
                        </div>
                        <div class="card-body"><div id="transcript-viewer"></div></div>
                     </div>
                  </section>
               </div>

               </div>
            </section>


            <section class="content">
               <div class="container-fluid">
                  <div class="row">
                  <section class="col-lg-12 ">
                     <div class="card">
                        <div class="card-header bg-light">
                           <h3 class="card-title">
                              <b>
                                 <i class="fas fa-info-circle"></i>
                              Variant Table
                           </b>
                           
                           </h3>
                           <div class="card-tools">
                              <button type="button" id="dtype-creator-btn" class="btn btn-block btn-dark">
                                 <i class="fas fa-question-circle"></i>                                    
                              </button>
                           </div>
                        </div>
  
                        <div class="card-body">

                          <div id = "clinvar-js-grid">
                          </div>
                          <div id = "populationvars-js-grid">
                          </div>
                     </div>
                     </div>
                  </section>
               </div>

               </div>
            </section>
            <!-- /.content -->
         </div>
         <!-- /.content-wrapper -->
         <footer class="main-footer">
            <strong>Copyright &copy; 2021 <a href="https://rarediseasegenomics.com.au">Computational Rare Disease Genomics</a></strong>.
            The data released here is available free of restrictions under the Creative Commons Zero Public Domain Dedication.

            <div class="float-right d-none d-sm-inline-block">
               <b>UTR Visualisation App</b> version 0.1
            </div>
         </footer>
         <!-- Control Sidebar -->
         <aside class="control-sidebar control-sidebar-dark">
            <!-- Control sidebar content goes here -->
         </aside>
         <!-- /.control-sidebar -->
      </div>
      <!-- ./wrapper -->
      <!-- jQuery -->
      <script src="{{url_for('static', filename = 'plugins/jquery/jquery.min.js')}}"></script>
      <!-- jQuery UI 1.11.4 -->
      <script src="{{url_for('static', filename = 'plugins/jquery-ui/jquery-ui.min.js')}}"></script>
      <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
      <script>
         $.widget.bridge('uibutton', $.ui.button)
      </script>
      <!-- Bootstrap 4 -->
      <script src="{{url_for('static', filename = 'plugins/bootstrap/js/bootstrap.bundle.min.js')}}"></script>
      <!-- ChartJS -->
      <script src="{{url_for('static', filename = 'plugins/chart.js/Chart.min.js')}}"></script>
      <!-- Sparkline -->
      <script src="{{url_for('static', filename = 'plugins/sparklines/sparkline.js')}}"></script>
      <!-- JQVMap -->
      <script src="{{url_for('static', filename = 'plugins/jqvmap/jquery.vmap.min.js')}}"></script>
      <script src="{{url_for('static', filename = 'plugins/jqvmap/maps/jquery.vmap.usa.js')}}"></script>
      <!-- jQuery Knob Chart -->
      <script src="{{url_for('static', filename = 'plugins/jquery-knob/jquery.knob.min.js')}}"></script>
      <!-- daterangepicker -->
      <script src="{{url_for('static', filename = 'plugins/moment/moment.min.js')}}"></script>
      <script src="{{url_for('static', filename = 'plugins/daterangepicker/daterangepicker.js')}}"></script>
      <!-- Tempusdominus Bootstrap 4 -->
      <script src="{{url_for('static', filename = 'plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js')}}"></script>
      <!-- Summernote -->
      <script src="{{url_for('static', filename = 'plugins/summernote/summernote-bs4.min.js')}}"></script>
      <!-- overlayScrollbars -->
      <script src="{{url_for('static', filename = 'plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js')}}"></script>
      <!-- AdminLTE App -->
      <script src="{{url_for('static', filename = 'dist/js/adminlte.js')}}"></script>
      <!-- AdminLTE for demo purposes -->
      <script src="{{url_for('static', filename = 'dist/js/demo.js')}}"></script>
      <!-- AdminLTE dashboard demo (This is only for demo purposes) -->
      <script src="{{url_for('static', filename = 'dist/js/pages/dashboard.js')}}"></script>
      <script src="{{url_for('static', filename = 'plugins/select2/js/select2.full.min.js')}}"></script>
      
      <script src="{{url_for('static', filename ='plugins/jsgrid/jsgrid.min.js')}}"></script>

      <script type="text/javascript">
         /**************Initial Start Up Routine****************/

 
         $(function() {

        /*************Info details data*******************/

        /*************5' Architechture*******************/

        //Initialize Feature Viewer 
        //Create a new Feature Viewer and add some rendering options
         var ft2 = new FeatureViewer.createFeature("AGAGACGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGAGAGGAAGAGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGCGGGCAGAGAGAAGAGTATATAGGTGATGAGAGCAGTGTTGGAGGGGAGGATCGGCAATAATTGGATGGCGTATATAGGTGATGAGAGCAGTGTTGTATATAGGTGATGAGAGCAGTGTT",
         "#transcript-viewer", {    
            showAxis: true,
            showSequence: true,
            brushActive: true,
            toolbar:true,
            bubbleHelp:true,
            zoomMax:10
            });

         //Add some features
         ft2.addFeature({
            data: [{x:20,y:32},{x:46,y:100},{x:123,y:167}],
            name: "uORFs",
            className: "test1",
            color: "#005572",
            type: "rect",
            filter: "type1"
         });
         ft2.addFeature({
            data: [{x:52,y:52},{x:92,y:92}],
            name: "uAUG variants",
            className: "test2",
            color: "#006588",
            type: "rect",
            filter: "type2"
         });

        /*************Population variation*******************/
         
         var gnomad_data = {{gnomad_data|tojson}};
         console.log(gnomad_data["transcript"]["clinvar_variants"])
         // Fill Clinvar data 
        
         $("#clinvar-js-grid").jsGrid({
          height: "100%",
          width: "100%",
          sorting: true,
          paging: true,
          data: gnomad_data["transcript"]["clinvar_variants"],
          fields: [
          { name: "clinvar_variation_id", type: "text", width: 150, title:"ClinVar Variation ID" },
          { name: "ref", type: "text", title:"REF"},
          { name: "alt", type: "text", title:"ALT"},
          { name: "pos", type: "text", title:"POS"},
          { name: "major_consequence", type: "text", title:"Major Consequence"},
          { name: "in_gnomad", type: "checkbox", title:"In gnomAD?" },
          { name: "clinical_significance", type: "text", title:"Clincal Significance" },
          { name: "hgvsc", type: "text", title:"HGVSC" },
          ]
      });
      console.log(gnomad_data["transcript"]["variants"])
      $("#populationvars-js-grid").jsGrid({
          height: "100%",
          width: "100%",
          sorting: true,
          paging: true,
          data: gnomad_data["transcript"]["variants"],
          fields: [
          { name: "variantId", type: "text",  title:"Variation ID" },
          { name: "ref", type: "text", title: "REF" },
          { name: "alt", type: "text", title: "ALT" },
          { name: "pos", type: "text", title: "POS" },
          { name: "transcript_consequence.major_consequence", type: "text", title: "Major Consequence" },
          { name: "genome.ac", type: "text", title: "AC" },
          { name: "genome.af", type: "text", title: "AF" },
          { name: "hgvsc", type: "text", title:"HGVSC" },
          ]
      });


})




      </script>

      <script>
   /*     
create_tables(gnomad_data);
function create_tables(gnomad_data){

   
   // Fill clinvar population data 
  var clinvar_variation_data = gnomad_data["transcript"]["clinvar_variants"];
  var clinvar_table = document.getElementById('clinvar_table');
  clinvar_variation_data.forEach(function(object) {
        var tr = document.createElement('tr');
        tr.innerHTML = 
        '<td>' + object.ref + '</td>'+
        '<td>' + object.alt + '</td>'+
        '<td>' + object.pos + '</td>'+
        '<td>' + object.in_gnomad + '</td>'+
        '<td>' +  + '</td>'+
        '<td>' + object.hgvsc + '</td>'+
        '<td>' + object.clinical_significance + '</td>'+
        '<td>' + object.clinvar_variation_id + '</td>';
        clinvar_table.appendChild(tr);
    });
  // Fill gnomAD population data 
  var population_variation_data = gnomad_data["transcript"]["variants"];
  var population_variation_table = document.getElementById('population_table');
  population_variation_data.forEach(function(object) {
        var tr = document.createElement('tr');
        tr.innerHTML = 
        '<td>' + object.variantId + '</td>'+
        '<td>' + object.ref + '</td>'+
        '<td>' + object.alt + '</td>'+
        '<td>' +  + '</td>'+
        '<td>' + object.pos + '</td>'+
        '<td>' + object.genome.af + '</td>'+
        '<td>' + object.genome.ac + '</td>';
        population_variation_table.appendChild(tr);
    });

  }
   
*/

      </script>
   </body>
</html>


